<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>السياسات</title>
<link rel="stylesheet" href="/css/style.css">
<script src="/js/pdf-helper.js" defer></script>
<style>
body { font-family: Arial; text-align: center; padding: 30px; background: #f4f6f8; }
h2 { margin-bottom: 25px; color: #333; }
#policiesContainer { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; }
.menu-btn { padding: 12px 20px; font-size: 1em; cursor: pointer; border: none; border-radius: 8px;
    background: #3498db; color: #fff; min-width: 200px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: 0.2s; }
.menu-btn:hover { background: #217dbb; transform: translateY(-2px); }
</style>
</head>
<body>
<h2>السياسات</h2>
<div id="policiesContainer"></div>

<script>
const params = new URLSearchParams(window.location.search);
const role = (params.get("role") || "").toLowerCase();
const container = document.getElementById("policiesContainer");

async function loadPolicies() {
  if (!role) {
    container.innerHTML = `<p>لم يتم تحديد الدور</p><button class="menu-btn" onclick="window.location.href='/'">العودة</button>`;
    return;
  }

  try {
    const res = await fetch(`/api/policies/${role}`);
    if (!res.ok) throw new Error("تعذر تحميل السياسات");
    const policies = await res.json();
    container.innerHTML = "";

    policies.forEach(p => {
      const btn = document.createElement("button");
      btn.className = "menu-btn";
      btn.textContent = p.title;
      btn.onclick = () => openPdfSmart(p.filename);
      container.appendChild(btn);
    });
  } catch (err) {
    container.innerHTML = `<p>تعذر تحميل السياسات</p><small>${err.message}</small>`;
  }
}

document.addEventListener("DOMContentLoaded", loadPolicies);
</script>
</body>
</html>
